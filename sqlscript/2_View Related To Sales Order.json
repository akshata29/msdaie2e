{
	"name": "2_View Related To Sales Order",
	"properties": {
		"folder": {
			"name": "WorldWideImporters/Logical Data Warehouse/Part 1"
		},
		"content": {
			"query": "-- As there are different options when creating views in terms of column selection and data type definition, the following 4 views use different syntax to illustrate the various options available.\n\n--LDW.vwCustomers: Uses HEADER_ROW = TRUE and SELECT *.\n--LDW.vwCities: Uses HEADER_ROW = TRUE then references the CSV column names in the SELECT.\n--LDW.vwStateProvinces: Uses HEADER_ROW = TRUE and the WITH statement to define column data types.\n--LDW.vwCountries: Uses FIRSTROW = 2 and the WITH statement to select columns based on their ordinal position and custom column names.\n\nUSE logicalDw\nGO\n--DROP VIEW LDW.vwCustomers\nCREATE VIEW LDW.vwCustomers\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Sales_Customers/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n--DROP VIEW LDW.vwCities\nCREATE VIEW LDW.vwCities\nAS\nSELECT CityID,\n    CityName,\n    StateProvinceID,\n    LatestRecordedPopulation\nFROM\n    OPENROWSET\n    (\n        BULK 'Application_Cities/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n-- DROP VIEW LDW.vwStateProvinces\nCREATE VIEW LDW.vwStateProvinces\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Application_StateProvinces/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    )\n    WITH\n    (\n        StateProvinceID TINYINT,\n        StateProvinceCode CHAR(2),\n        StateProvinceName VARCHAR(30),\n        CountryID TINYINT,\n        SalesTerritory VARCHAR(14),\n        LatestRecordedPopulation INT\n    ) AS fct\n\n\n-- DROP VIEW LDW.vwCountries\nCREATE VIEW LDW.vwCountries\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Application_Countries/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        FIRSTROW = 2,\n        FIELDTERMINATOR ='|'\n    )\n    WITH\n    (\n        CountryID TINYINT 1,\n        Country VARCHAR(50) 2,\n        IsoCode3 CHAR(3) 4,\n        CountryType VARCHAR(50) 6,\n        LatestRecordedPopulation INT 7,\n        Continent VARCHAR(50) 8,\n        Region VARCHAR(50) 9,\n        Subregion VARCHAR(50) 10\n    ) AS fct\n\n-- The remainder of the Views created will use the HEADER_ROW = TRUE syntax with SELECT * for code brevity, feel free to amend as necessary.\n-- DROP VIEW LDW.vwBuyingGroups\nCREATE VIEW LDW.vwBuyingGroups\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Sales_BuyingGroups/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n-- DROP VIEW LDW.vwDeliveryMethods \nCREATE VIEW LDW.vwDeliveryMethods\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Application_DeliveryMethods/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n-- DROP VIEW LDW.vwCustomerCategories\nCREATE VIEW LDW.vwCustomerCategories\nAS\n    SELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Sales_CustomerCategories/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n-- DROP VIEW LDW.vwPeople \nCREATE VIEW LDW.vwPeople\nAS\nSELECT * FROM\n    OPENROWSET\n    (\n        BULK 'Application_People/*.csv',\n        DATA_SOURCE = 'ExternalRawDataLake',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        HEADER_ROW = TRUE,\n        FIELDTERMINATOR ='|'\n    ) AS fct\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "logicaldw",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}